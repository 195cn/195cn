# Pi Pico功率器件控制板



# 前言

在RP2040欧姆表做完以后，又重新学习了一下三极管和MOS管的知识。这一次做了一个双路MOS管+ADC读取的Pico扩展版。
这一次目的比较明确，主要是验证三极管和MOS管的使用。测试了驱动直流风扇，直流电机（500mA左右），3D打印机的加热棒（40W）。
并且做了个简单的温控，由于不会PID控制，只是简单的温度判断。

# 原理解析

原理图如下：



## 三极管

功能是电平转换，把IO的3.3V转换成12V来打开MOS管。
只考虑NPN三极管做下管，选用常用的S8050，三根脚的用法如下：

- C：集电极（接上拉电阻，MOS管G）
- E：发射极（接地）
- B：基极（接GPIO）

反正PWM控制，只有高低电平，也就是GND和3.3V。BC两端电阻是一样的，电流倍数很小，只要过了那个啥死区电压还是什么，肯定就能导通。限流电阻用了10K的，实测可行。
PICO引脚上电是高电平，B高电平，CE导通，C点电位为GND。B低电平，CE断开，C点电位为12V。

## MOS管

也是做下管，用NMOS管，随便买了个一IRF520N，当时也不懂。其实应该买逻辑电平的，但买都买了。
NMOS做下管，不用考虑电流，G电压够高就行。只看一个参数Vgsth，一般的都是2~4V，到10V才能完全打开。所以无脑接12V就可以了。刚开始学模电，后面再仔细研究。

NMOS的三根引脚接法如下：

- G：栅极（接NPN的C）
- D：漏极（接负载）
- S：源极（接地）
  接了个LED用来做指示，这里发现一个BUG，如果Pico没供电或者干脆没插的时候，三极管B低电平关断。C就是12V，MOS管G12V导通，后面考虑加个DCDC给Pico供电。要不然加个自锁开关或者继电器。

# 原理图设计

4个按键（包括复位），LCD屏幕，两组MOS管功率电路，一组ADC检测。
这一次加了电容，复位键加上是防止电路抖动异常复位。其余的几个100uf电容，我从RAMPS1.4上抄的，看同事画的PCB，也经常有这个。

# PCB布局

额，12V先给了2.54mm，也就是100mil的线宽，估算能走4A的电流。
但其实不够用，像我常用的负载可能要10A才可以，可能还要参考其他的电路。还有就是，GND不够粗，只给了2mm。。。嘛，不用在意这些细节。
自己画了MOS管相关的走线，其余的都是自动布线的。

# 调试

## 代码

想用PID的，但是没看懂。
也没啥值得说的，就屏幕显示，按键检测，PWM输出，还有一个NTC电阻测温。
依然用的是MicroPython。

## 上电验证

先买了两个365直流电机，做了一下调速控制，还是比较满意的。唯一问题就是，2.3的出轴插不进买的螺旋桨。
然后就是用3D打印的喷头总成，做了一个温控系统。

# 总结

现在的水平能画不少东西了，可以暂时告一段落去搞别的东西了。
如果这次还是按之前的思路，先看书看明白再行动，是不可能有进展的。
下一步可能要着重看一下RC电路，感性负载，电机驱动这方面的东西，也要多参考一些成熟电路。